<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="æˆ‘ä»¬çš„å¾é€”æ˜¯æ˜Ÿè¾°å¤§æµ·">
  <meta name="keyword" content="hexo-theme, vuejs">
  
    <link rel="shortcut icon" href="/css/images/logo.png">
  
  <title>
    
      Defcon CTF Quals 2018 | æ˜Ÿåšâ€˜s
    
  </title>
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">
  <link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/tomorrow.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/plugins/gitment.css">
  <script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
  <script src="//cdn.bootcss.com/geopattern/1.2.3/js/geopattern.min.js"></script>
  <script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>
  <script src="/js/qrious.js"></script>
<script src="/js/gitment.js"></script>
  
  
    <!-- MathJax support START -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- MathJax support END -->
  


</head>
<div class="wechat-share">
  <img src="/css/images/logo.png" />
</div>

  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span>æ˜Ÿåšâ€˜s</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">Tags</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">Archives</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/about/" class="item-link">About</a>
          
        </li>
      
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">Tags</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">Archives</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/about/" class="menu-link">About</a>
            
          </li>
        
      </ul>
    </div>
  </div>
</header>

    <div id="article-banner">
  <h2>Defcon CTF Quals 2018</h2>
  <p class="post-date">2018-05-16</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body flex-box">
  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content"><p>ä¸Šå‘¨æœ«æ˜¯ Defcon CTF Quals 2018çš„æ¯”èµ›ï¼Œä»Šå¹´æ˜¯æ›´æ¢ä¸»åŠæ–¹çš„ç¬¬ä¸€å¹´ï¼Œä¹‹å‰éƒ½æ˜¯ <strong>Legitimate Business Syndicate</strong>ï¼Œæ¯”èµ›è´¨é‡ä¹Ÿä¸€ç›´å¾ˆé«˜ï¼›ç„¶è€Œå»å¹´Defcon CTF çš„äº”å¹´åˆåŒåˆ°æœŸï¼Œäºæ˜¯ä»Šå¹´æ˜¯æ–°çš„ä¸»åŠæ–¹ï¼Œæ‹–äº† n ä¹…æ‰ç¡®å®šçš„ <a href="https://www.oooverflow.io/" target="_blank" rel="noopener"><strong>Order of the Overflow</strong></a>ã€‚</p>
<p>å¤§ä½¬ä»¬ä¸€å¤§éƒ¨åˆ†æ¥è‡ªShellphishï¼Œä¾‹å¦‚éå¸¸çœ¼ç†Ÿçš„<strong>Yan Shoshitaishvili (@Zardus)</strong>ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä»–ä»¬ä¸­å¾ˆå¤šéƒ½æ˜¯å¹´è½»æ•™æˆã€‚èµ›å‰ä¸€å¤©åœ¨ Defcon China ç¢°åˆ°å†¯è€å¸ˆï¼Œæ‰“å¬åˆ°ä»–ä¹Ÿå‚ä¸äº†å‡ºé¢˜å®¡é¢˜ã€‚</p>
<p>ä»Šå¹´ä¾æ—§æ˜¯è¢« <strong>Tea Delieverers</strong> é€’èŒ¶é˜Ÿçš„å¤§ä½¬ä»¬å¸¦é£ï¼Œæˆ‘å¸®å¿™æ‰“ä¸‹æ‰‹ã€‚ä¹‹å‰åœ¨ PCTF ä¸­ä¸€ååªå·®æ²¡æœ‰å¤–å¡ï¼Œéå¸¸å¯æƒœï¼Œè¿™æ¬¡æ¨åšå£«å’Œå„ä½å²å‰å·¨ä½¬ä»¬ï¼ˆåˆå¤šåˆå¼ºï¼‰ä¸€èµ·å‡ºåŠ¨ï¼Œå¾ˆè¾›è‹¦çš„è®¤çœŸæ€¼äº†ä¸¤å¤©ï¼Œæ‹¿åˆ°äº†<strong>ç¬¬å…­å</strong>çš„å¥½æˆç»©ã€‚</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1frcgega3ksj31890ef158.jpg" alt=""></p>
<p>æ¥ä¸‹æ¥ä»æˆ‘çš„è§’åº¦ï¼Œåˆ—ä¸¾å‡ é“ Binary é¢˜ç›®ä¾›å¤§å®¶ä½“ä¼šé¢˜ç›®çš„æ¸…å¥‡é£æ ¼ã€‚</p>
<hr>
<h2 id="TechSupport"><a href="#TechSupport" class="headerlink" title="TechSupport"></a>TechSupport</h2><p><strong>TL;DRï¼š</strong> Gdb è°ƒè¯• + Patch + Info leakï¼Œéš¾åº¦ä½ï¼Œæœ‰æ–°æ„ã€‚</p>
<h4 id="Vulnerability"><a href="#Vulnerability" class="headerlink" title="Vulnerability"></a>Vulnerability</h4><p>é¢˜ç›®ç»™çš„ Binary æ˜¯ä¸€ä¸ªåŒ–å­¦åˆ†å­é‡è®¡ç®—å™¨ï¼Œé¢˜ç›® Binary å¾ˆå°ï¼Œæ ¸å¿ƒä»£ç ï¼š</p>
<p><img src="https://ws4.sinaimg.cn/large/006tNc79ly1frcgqkj0tzj30k3046q3o.jpg" alt=""></p>
<p>ä½†è¿œç¨‹è¿è¿›å»æ˜¯ä¸€ä¸ªï¼ˆä¼ªï¼‰AI å®¢æœé—®ä¸€äº› SB é—®é¢˜ï¼Œå›ç­”å®Œä¹‹åè¯´ä½ åœ¨å…¬ç½‘ç›‘å¬3456ç«¯å£å®ƒä¼šè¿æ¥ï¼Œæ„Ÿè§‰è¿™ä¸ªå½¢å¼æ¯”è¾ƒæœ‰æ–°æ„ã€‚è¿è¿›æ¥ä¹‹åï¼Œå‘ç°æ˜¯ gdb è°ƒè¯•å‘½ä»¤ï¼Œåœ¨æœ¬åœ°<code>gdbserver</code>æ‰§è¡Œï¼Œç„¶åæç¤º license ä¸å¯¹ã€‚</p>
<p><strong>æ¥ä¸‹æ¥çš„æ‰€æœ‰è¿‡ç¨‹å°±æ˜¯æŒ‰ç…§ä¸»åŠæ–¹çš„å¼•å¯¼èµ°ä¸‹å»</strong>ã€‚</p>
<p>åˆ†æ <code>gdbserver</code> æµé‡å¾—çŸ¥ï¼Œå…¶åœ¨licenseæ£€æŸ¥å®Œçš„å‡½æ•°å‡ºå£ä¸‹æ–­ç‚¹å¹¶æ‰§è¡Œã€‚åŒæ—¶ä¼šéšæœºä¸Šä¼ ä¸€æ®µ Binary çœ‹æ˜¯å¦æ‰“ Patchã€‚é‚£æˆ‘ä»¬ç¬¬ä¸€æ­¥ï¼Œåœ¨ <code>eh_frame</code> å¤„ <code>patch + è·³è½¬</code>ï¼Œè¿‡äº† license çš„æ£€æŸ¥ï¼›äºæ­¤åŒæ—¶å¼€å§‹æ— è„‘å†™ <code>Angr Script</code>ã€‚ï¼ˆåæ¥ license ç¡®å®æ˜¯ Flagï¼Œåªä¸è¿‡ Angr è·‘ä¸å‡ºæ¥ï¼Œæµªè´¹äº†åŠå¤©ï¼‰</p>
<p>ä¹‹åï¼Œå®¢æœå‘Šè¯‰æˆ‘ï¼Œ Crash äº†æ‰ä¼šå¤„ç†ã€‚æœ‰ Binary Crash è¿˜ä¸å®¹æ˜“ï¼Œéšä¾¿ Patch ä¸ªæ— æ•ˆåœ°å€å–ï¼Œå¹¶è§‚å¯Ÿ <code>gdbserver</code> çš„æµé‡ï¼Œå‘ç° Crash åä¼šæŠŠæˆ‘çš„å¤„ç†å‚æ•°å–å›å»æ‰§è¡Œï¼Œå¹¶è¿”å›ç»“æœä»–é‚£é‡Œæ²¡æœ‰ Crashã€‚é—®é¢˜å°±å˜æˆäº†ï¼Œå¦‚ä½•æ„é€ å‚æ•°ä½¿è¿œç¨‹ Crashã€‚</p>
<p>Binary å°±å¾ˆå°ï¼Œç¿»äº†åŠå¤©æ²¡æœ‰ä»»ä½•æº¢å‡ºå¯èƒ½ï¼Œä¸è¿‡ Crash è¿˜æ˜¯å¯ä»¥çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cal_main_element(<span class="keyword">int</span> *element_weight_stack)</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"The main element is %s, which accounts for %d%% of the total weight\n"</span>, </span><br><span class="line">  &amp;element_name[<span class="number">2</span> * idx],(<span class="keyword">unsigned</span> <span class="keyword">int</span>)(<span class="number">100</span> * max / sum));</span><br></pre></td></tr></table></figure>
<ol>
<li><strong><code>element_weight_stack</code>åœ¨å¯¹å…ƒç´ è´¨é‡åšç»Ÿè®¡æ—¶æ˜¯ç›´æ¥è¦†ç›–</strong>;</li>
<li><strong><code>cal_main_element</code> å¯èƒ½é™¤0</strong>ï¼›</li>
</ol>
<p>é‚£ä¹ˆæˆ‘ä»¬åªè¦åœ¨è¾“å…¥å…ƒç´ æ—¶ï¼Œå¦‚ <code>./mcalc Ag5Ag0</code>ï¼Œåˆ™ç»Ÿè®¡ç»“æœæ˜¯0ã€‚åˆ™è§¦å‘ Crashï¼Œè¿œç¨‹ä¼šå‘Šè¯‰æˆ‘ä»¬å’Œå®ƒ Crash æ—¶çš„ä¸åŒï¼Œä¼šæ‰“å°å¦‚ä¸‹ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#$#!!%^!!</span><br><span class="line">It seems like our program has crashed</span><br><span class="line">Just give me a second to try to reproduce the bug on our servers...</span><br><span class="line">I confirm that we were able to reproduce the bug on our side</span><br><span class="line">These are the differences in the program state at the moment it crashed:</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line">REG              OUR SERVER                          YOUR INSTALLATION</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line">rsi | 0x000000000001                      | 0x0000deadbeef</span><br><span class="line">r13 | 0x7fffffffed00 &gt; 0x0000000000000002 | 0x7fffffffe2a0 &gt; 0x0000000000000002</span><br><span class="line">rcx | 0x00000001a55c                      | 0x0000deadbeef</span><br></pre></td></tr></table></figure>
<h4 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h4><p>èµ°åˆ°è¿™é‡Œåªå‰©ä¸‹ä¸€æ­¥äº†ã€‚å½“æ—¶é™·å…¥äº†è¯¯åŒºï¼Œå°è¯•ç»§ç»­æŒ‰ç…§å®¢æœè¦æ±‚ï¼Œæ„é€ å®Œå…¨ç›¸åŒçš„ Crash åœºæ™¯ï¼Œç»“æœå¤±è´¥ã€‚æ¨åšå£«æé†’è¯´ï¼Œæœ‰å¯èƒ½æ˜¯åœ¨<strong>æ‰“å°å¯„å­˜å™¨ä¿¡æ¯å¯¼è‡´ Inforleak</strong>ã€‚æŸ¥çœ‹ Crash ç‚¹çš„å¯„å­˜å™¨ï¼Œå‘ç°ï¼Œ<strong>RCX</strong>å¯„å­˜å™¨ä¸­å­˜çš„æ˜¯æˆ‘ä»¬åˆ†å­é‡çš„æ€»å’Œï¼Œæˆ‘ä»¬åªéœ€è¦æ„é€ åˆ†å­é‡æŒ‡å‘ BSS æ®µçš„ <code>License (0x6033D0)</code>å³å¯ã€‚</p>
<p>æœ€åä¸€æ­¥ï¼Œ<a href="(https://github.com/cxm95/CTF-Writeups/blob/master/DefconCTF_Quals_2018/tech-support/test.cpp"><strong>åŠ¨æ€è§„åˆ’ä¸€ä¸‹</strong></a>)ï¼Œé¢˜ç›®æ‰€ç»™çš„åˆ†å­é‡å¾ˆéš¾ç›´æ¥æ„é€ ç²¾ç¡®åœ°å€ï¼Œäºæ˜¯ç®—æ³•å¼±æ¸£æ¡èµ· DPï¼Œæ„é€ ç²¾ç¡®å€¼ï¼Œæœ€åå¾—åˆ° Flag å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#$#!!%^!!</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line">REG              OUR SERVER                          YOUR INSTALLATION</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line">rbx | 0x000000000000                      | 0x0000deadbeef</span><br><span class="line">rcx | 0x0000006033d8 &gt; 0x31345e3339252565 | 0x0000deadbeef</span><br><span class="line"></span><br><span class="line">./mcalc Fm23Au1Pr1Fm0Au0Pr0FeFe00</span><br><span class="line">./mcalc Fm22Cf1Tl1Er1Fm0Cf0Tl0Er0SiSi00</span><br><span class="line">license(flag): %%license%%93^41</span><br></pre></td></tr></table></figure>
<h4 id="And-Finally"><a href="#And-Finally" class="headerlink" title="And Finally"></a>And Finally</h4><p>äºæ˜¯ï¼Œæˆ‘ä»¬ä½œä¸ºä¸€ä¸ªç›—ç‰ˆç”¨æˆ·ï¼Œä»å®¢æœæ‰‹ä¸­æ‹¿åˆ°äº†çœŸæ­£çš„ Licenseã€‚ä¸åŒäºåƒç¯‡ä¸€å¾‹çš„å¥—è·¯é¢˜ï¼Œé«˜è´¨é‡ CTF å¾€å¾€ä¸æŒ‰å¥—è·¯å‡ºç‰Œï¼Œæœ‰è¶£ä¹Ÿèƒ½å­¦åˆ°ä¸œè¥¿ï¼Œè€Œä¸æ˜¯æ‹¿å·²æœ‰çš„åˆ©ç”¨å¥—è·¯åå¤ç”¨æ¥ç”¨å»ï¼Œè¿™ç‚¹å€¼å¾—å›½å†…çš„ CTF å¤šå¤šå­¦ä¹ ã€‚</p>
<p>å½“ç„¶ï¼Œè¿™æ¬¡ CTF ä¹Ÿæœ‰å¾ˆå¤šå€¼å¾—åæ§½çš„åœ°æ–¹ï¼Œæ¯”å¦‚æµªè´¹ç”Ÿå‘½çš„ <strong>POW</strong>ï¼Œå›½å†…éƒ½å·²ç»ä¸å¤šè§çš„<strong>çŒœçŒœçŒœ</strong>é¢˜ç›®ï¼Œä½“éªŒå¾ˆå·®ï¼Œå¯ä»¥åˆ°<a href="https://ctftime.org/event/608" target="_blank" rel="noopener">CTFTime</a> æ„Ÿå—ä¸€ä¸‹ã€‚</p>
<hr>
<h2 id="Other-Challenges"><a href="#Other-Challenges" class="headerlink" title="Other Challenges"></a>Other Challenges</h2><h3 id="Babypwn1805"><a href="#Babypwn1805" class="headerlink" title="Babypwn1805"></a>Babypwn1805</h3><p>ç»™äº†å‡ è¡Œä»£ç ï¼Œæ²¡æœ‰ Binaryï¼Œæä¾›äº†æ–¹ä¾¿çˆ†ç ´çš„é‡å¤å¯åŠ¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">char asdf[1024];</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	long long index = 0;</span><br><span class="line">	read(0, &amp;index, 1024);</span><br><span class="line">	read(0, asdf+index, 8);</span><br><span class="line">	read(0, &amp;index, 1024);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>åˆ©ç”¨</strong>ï¼šè·³ <code>OneGadget</code>ï¼Œä¸è¿‡åšå‡ºæ¥ä¹‹åå‘ç°æ¯æ¬¡å¯åŠ¨éƒ½ä¼šæ¢ <code>Libc</code>ã€‚æ— åŠ›åæ§½ï¼Œä¸çŸ¥ <code>intended solution</code> æ˜¯ä»€ä¹ˆã€‚</p>
<h3 id="Bitflipper"><a href="#Bitflipper" class="headerlink" title="Bitflipper"></a>Bitflipper</h3><p>å—¯ï¼Œæ²¡é”™ï¼Œè¿™æ¬¡çš„é¢˜ç›®éƒ½ä¸å–œæ¬¢ç»™ Binaryã€‚è¿™æ¬¡çš„å†…å®¹æ˜¯ä¿®æ”¹4bit ä¹‹åå¸®ä½ æ‰§è¡ŒBinaryï¼ŒBinary æ­£å¸¸å·¥ä½œæ˜¯æœ‰é¢œè‰²çš„ ls å‘½ä»¤ã€‚é¢˜ç›®å¯ä»¥ç†è§£ä¸ºåœ¨ RowHammer çš„æ¡ä»¶ä¸‹å¦‚ä½•å½±å“ç¨‹åºæ‰§è¡Œï¼›æ®è¯´ RowHarmmer æ‰§è¡Œçš„æ¡ä»¶è¶Šæ¥è¶Šä½ï¼ˆ<a href="https://arxiv.org/abs/1710.00551" target="_blank" rel="noopener">Another Flip in the Wall of Rowhammer Defenses</a>ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ Which bit do you want to flip (0-81727)? 10000</span><br><span class="line">1 bits have been flipped</span><br><span class="line">MD5 of the new version: 55cb4321919e63cc65676689ba33066d</span><br><span class="line">Let me run the program for you now...</span><br><span class="line">-------------------------------------------------------</span><br><span class="line">[-8mREADME</span><br><span class="line">abc.jpg</span><br><span class="line">[-8mdir</span><br><span class="line">[-8msecret_flag.txt</span><br><span class="line">test.doc</span><br><span class="line">[-8mversion.txt</span><br><span class="line">-------------------------------------------------------</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…ï¼Œä¼šæç¤ºæƒ³æŠŠ Crash å‘ç»™æˆ‘ä»¬ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bash: ./dir: cannot execute binary file: Exec format error</span><br><span class="line">-------------------------------------------------------</span><br><span class="line">Looks like you broke it!</span><br><span class="line">I would send you a core dump, but I could not find any in the current directory</span><br></pre></td></tr></table></figure>
<p>ä¸€å¼€å§‹æ²¡æœ‰æ€è·¯çš„æƒ…å†µä¸‹ï¼Œå¤§å®¶è¿›è¡Œäº†æƒ¨æ— äººé“çš„çˆ†ç ´ã€‚</p>
<p><strong>åˆ©ç”¨ï¼š</strong></p>
<p>é¦–å…ˆï¼Œé€šè¿‡æ”¹ Binary å¤´éƒ¨ type å­—æ®µï¼Œå°†å…¶è¯†åˆ«ä¸ºCrash æ–‡ä»¶ï¼Œå¦‚æ­¤ Dump å‡º Binaryã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œä¿®æ”¹ 4 bit å½±å“ç¨‹åºçš„æ‰§è¡Œç»“æœï¼Œå¤§æ¦‚æ€è·¯æ˜¯ä¿®æ”¹ä¸€äº›å‡½æ•°è°ƒç”¨ç­‰å…³é”®ä½ç½®çš„å¯„å­˜å™¨å€¼ã€‚æ²¡æœ‰å¾æ±‚è§£é¢˜å¤§ä½¬çš„æ„è§ï¼Œä¸åˆ—ä¸¾ç»†èŠ‚ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è€ƒè™‘ä¸€ä¸‹ã€‚</p>
<h3 id="Shellql"><a href="#Shellql" class="headerlink" title="Shellql"></a>Shellql</h3><p>ç»™äº† Binary çš„ä¸€é¢˜ï¼Œä¸€ä¸ª php åŠ è½½çš„åº“ï¼Œä¸Šæ¬¡è§åˆ°ç±»ä¼¼çš„é¢˜è¿˜æ˜¯åœ¨ Pwnhub ã€‚é¢˜ç›®å¯ä»¥æ‰§è¡Œ Shellcodeï¼Œä½†æ˜¯å¼€äº†æ²™ç®±ä¿æŠ¤ï¼Œåªèƒ½æ‰§è¡Œ read/write/exitï¼ŒShellcode éœ€è¦å®Œæˆçš„å·¥ä½œï¼Œä»æ•°æ®åº“ä¸­æŸ¥è¯¢ flagï¼Œå¹¶æŠŠç»“æœè¿”å›ï¼›å½“ç„¶ï¼Œè¿˜éœ€è¦ leak æ‰èƒ½å®Œæˆæ•´ä¸ªè¿‡ç¨‹ã€‚</p>
<p><strong>åˆ©ç”¨ï¼š</strong></p>
<p>å¯ä»¥é€šè¿‡æ ˆåœ°å€æŠŠ PHP Binary Dump ä¸‹æ¥ï¼Œå¹¶åˆ©ç”¨å…¶ä¸­çš„ Eval ç±»æ–¹æ³•ï¼ˆä¼šè§¦å‘ Syscall é€€å‡ºï¼ŒPassï¼‰ï¼Œæˆ–è€…å‘å·²ç»æ‰“å¼€äº† fd çš„æ•°æ®åº“å‘é€æŸ¥è¯¢ã€‚</p>
<p>å‚è€ƒ: <a href="https://blog.vero.site/post/shellql" target="_blank" rel="noopener">veroâ€™s blog</a>ï¼Œåˆ™æ˜¯é€šè¿‡ Sql æŸ¥è¯¢ï¼ŒåŸºäºæ—¶é—´çš„ç›²æ³¨ä¸€ä½ä½çŒœå‡º Flagã€‚</p>
<h3 id="NOP"><a href="#NOP" class="headerlink" title="NOP"></a>NOP</h3><p>ç»™äº† Binary çš„è®®é¢˜ã€‚Shellql éœ€è¦æ„é€ åŠŸèƒ½ Shellcodeï¼Œè¿™é¢˜åˆ™æ˜¯ç»å…¸çš„ Shellcode é¢˜ç›®ï¼Œå­—ç¬¦é™åˆ¶åœ¨éŸ³ç¬¦ä¸­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C1 C#1 D1 D#1 ... B1 C2 C#2...B9</span><br></pre></td></tr></table></figure>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79ly1frciysrcr3j312g0o6grf.jpg" alt=""></p>
<p>é¢˜ç›®é€šè¿‡ä¸€ä¸ªå¥‡æ€ªçš„æ˜ å°„æŠŠ<code>0x001b - 0x67de</code>èŒƒå›´å†…çš„æ•°å­—æ˜ å°„åˆ°è¿™äº›éŸ³ç¬¦ä¸Šã€‚åœ¨è¿›å…¥ Shellcode ä¹‹å‰ï¼Œä¼šæ¸…ç©ºæ‰€æœ‰å¯„å­˜å™¨ï¼Œåœ¨æ ˆä¸Šæ”¾ä¸Šå¾ˆå¤šåƒåœ¾å†…å®¹ã€‚Shellcode ä½ç½®ä½äº<code>0x606000</code>ã€‚</p>
<p><strong>åˆ©ç”¨</strong>ï¼š</p>
<p>ç»å…¸ Shellcode é¢˜ä¸€èˆ¬æ€è·¯ï¼š<strong>é¦–å…ˆ</strong>çœ‹å¯åˆ©ç”¨çš„æŒ‡ä»¤ï¼›å¦‚æœå·²æœ‰æŒ‡ä»¤ä¸å¤Ÿç”¨ï¼Œåˆ™<strong>å…¶æ¬¡</strong>ä½¿ç”¨å¯åˆ©ç”¨çš„æŒ‡ä»¤ä»¥åŠç°åœºæ•°æ®æ„é€ è‡ªå·±çš„åœ°å€ï¼Œå¯¹Shellcode è‡ªèº«è¿›è¡Œä¿®æ”¹ï¼›<strong>æ¥ä¸‹æ¥</strong>æ„é€  Readï¼Œè¯»å…¥çœŸæ­£çš„ Shellcodeï¼Œå¹¶æ‰§è¡Œã€‚</p>
</section>
    <!-- Tags START -->
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tags#Pwn" >
    <span class="tag-code">Pwn</span>
  </a>

  <a href="/tags#CTF" >
    <span class="tag-code">CTF</span>
  </a>

      </div>
    
    <!-- Tags END -->
    <!-- NAV START -->
    
  <div class="nav-container">
    <!-- reverse left and right to put prev and next in a more logic postition -->
    
      <a class="nav-left" href="/2018/04/11/Academic_share/">
        <span class="nav-arrow">â† </span>
        
          è®ºæ–‡é˜…è¯»åˆ†äº«(2018)
        
      </a>
    
    
      <a class="nav-right" href="/2018/10/11/BOP_Share/">
        
          BOP-Block Oriented Programing(CCS 18)
        
        <span class="nav-arrow"> â†’</span>
      </a>
    
  </div>

    <!-- NAV END -->
    <!-- æ‰“èµ START -->
    
    <!-- æ‰“èµ END -->
    <!-- äºŒç»´ç  START -->
    
      <div class="qrcode">
        <canvas id="share-qrcode"></canvas>
        <p class="notice">æ‰«æäºŒç»´ç ï¼Œåˆ†äº«æ­¤æ–‡ç« </p>
      </div>
    
    <!-- äºŒç»´ç  END -->
    
      <!-- UY START -->
      <div id="uyan_frame"></div>
      <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js"></script>
      <!-- UY END -->
    
  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
    <aside class="catalog-container">
  <div class="toc-main">
    <strong class="toc-title">Catalog</strong>
    
      <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#TechSupport"><span class="toc-nav-text">TechSupport</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Vulnerability"><span class="toc-nav-text">Vulnerability</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Exploit"><span class="toc-nav-text">Exploit</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#And-Finally"><span class="toc-nav-text">And Finally</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Other-Challenges"><span class="toc-nav-text">Other Challenges</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Babypwn1805"><span class="toc-nav-text">Babypwn1805</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Bitflipper"><span class="toc-nav-text">Bitflipper</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#Shellql"><span class="toc-nav-text">Shellql</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#NOP"><span class="toc-nav-text">NOP</span></a></li></ol></li></ol>
    
  </div>
</aside>
  
  <!-- Catalog END -->
</main>

<script>
  (function () {
    var url = 'https://windcarp.github.io/2018/05/16/Defcon CTF Quals 2018/';
    var banner = 'undefined'
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

     // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', 'http://file.muyutech.com/error-img.png')
      $(this).css({
        'cursor': 'default'
      })
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== 'http://file.muyutech.com/error-img.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()
        
        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })

    // qrcode
    var qr = new QRious({
      element: document.getElementById('share-qrcode'),
      value: document.location.href
    });

    // gitment
    var gitmentConfig = "undefined";
    if (gitmentConfig !== 'undefined') {
      var gitment = new Gitment({
        id: "Defcon CTF Quals 2018",
        owner: "undefined",
        repo: "undefined",
        oauth: {
          client_id: "undefined",
          client_secret: "undefined"
        },
        theme: {
          render(state, instance) {
            const container = document.createElement('div')
            container.lang = "en-US"
            container.className = 'gitment-container gitment-root-container'
            container.appendChild(instance.renderHeader(state, instance))
            container.appendChild(instance.renderEditor(state, instance))
            container.appendChild(instance.renderComments(state, instance))
            container.appendChild(instance.renderFooter(state, instance))
            return container;
          }
        }
      })
      gitment.render(document.getElementById('comments'))
    }
  })();
</script>

    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer">
  <p class="copyright">
    &copy; 2019 | Proudly powered by <a href="https://hexo.io" target="_blank">Hexo</a>
    <br>
    Theme by <a href="https://github.com/yanm1ng">yanm1ng</a>
  </p>
</footer>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<script>
  async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script>

<script>
  var hasLine = 'true';
  async("//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js", function(){
    $('figure pre').each(function(i, block) {
      var figure = $(this).parents('figure');
      if (hasLine === 'false') {
        figure.find('.gutter').hide();
      }
      var lang = figure.attr('class').split(' ')[1] || 'code';
      var codeHtml = $(this).html();
      var codeTag = document.createElement('code');
      codeTag.className = lang;
      codeTag.innerHTML = codeHtml;
      $(this).attr('class', '').empty().html(codeTag);
      figure.attr('data-lang', lang.toUpperCase());
      hljs.highlightBlock(block);
    });
  })
</script>
<!-- Baidu Tongji -->

<script src="/js/script.js"></script>
  </body>
</html>